"use strict";(globalThis.webpackChunk_wp_playground_playground_block=globalThis.webpackChunk_wp_playground_playground_block||[]).push([[882],{262:(e,t,n)=>{n.d(t,{Ne:()=>l,Ul:()=>a,_J:()=>r,tg:()=>o});const r=["blueprint","blueprintUrl","codeEditorErrorLog","constants","files"];function a(e){const t={};for(const n in e)r.includes(n)&&"number"!=typeof e[n]&&"boolean"!=typeof e[n]&&null!==typeof e[n]&&void 0!==typeof e[n]?t[n]=l(JSON.stringify(e[n])):t[n]=e[n];return"files"in t&&(t.files=[t.files]),t}function o(e){const t={};for(const a in e){let o=e[a];if("files"===a&&(o=o[0]),r.includes(a)&&"string"==typeof o){if(a in e)try{t[a]=JSON.parse((n=o,(new TextDecoder).decode(function(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return r}(n))))}catch(n){t[a]=e[a]}}else t[a]=e[a]}var n;return t}function l(e){return function(e){const t=[],n=e.byteLength;for(let r=0;r<n;r++)t.push(String.fromCharCode(e[r]));return window.btoa(t.join(""))}((new TextEncoder).encode(e))}},562:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{Z:()=>l});var a=n(885),o=e([a]);async function l(e,t){const n=await e.documentRoot;let r=n+"/wp-content/plugins/demo-plugin",a="wordpress-playground-plugin.zip";"theme"==t&&(r=n+"/wp-content/themes/demo-theme",a="wordpress-playground-theme.zip"),s(new File([await i(e,r)],a,{type:"application/zip"}))}async function i(e,t){const n="/tmp/archive.zip",r=await e.run({code:`<?php\n\t\t\t\tif(file_exists(${(0,a.phpVar)(n)})) {\n\t\t\t\t\tunlink(${(0,a.phpVar)(n)});\n\t\t\t\t}\n\t\t\t\t$zip = new ZipArchive;\n\t\t\t\t$zip->open(${(0,a.phpVar)(n)}, ZipArchive::CREATE | ZipArchive::OVERWRITE);\n\t\t\t\t$files = new RecursiveIteratorIterator(\n\t\t\t\t\tnew RecursiveDirectoryIterator(${(0,a.phpVar)(t)}),\n\t\t\t\t\tRecursiveIteratorIterator::LEAVES_ONLY\n\t\t\t\t);\n\n\t\t\t\tforeach ($files as $name => $file) {\n\t\t\t\t\tif (!$file->isDir()) {\n\t\t\t\t\t\t$filePath = $file->getRealPath();\n\t\t\t\t\t\t$relativePath = substr($filePath, ${t.length} + 1);\n\n\t\t\t\t\t\t$zip->addFile($filePath, $relativePath);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$zip->close();\n\t\t\t\techo 'done';\n\t\t\t`});return"done"!==r.text&&(console.log("Error creating zip file"),console.log(r.errors),console.log(r.text)),await e.readFileAsBuffer(n)}function s(e){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=e.name,n.click()}a=(o.then?(await o)():o)[0],r()}catch(c){r(c)}}))},781:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(196),a=n(307),o=n(982),l=n(609);function i({title:e,onSave:t,error:n,isLoading:i,onRequestClose:s,file:c}){const[d,u]=(0,a.useState)(c?.name||""),[p,m]=(0,a.useState)(c?.remoteUrl||"");return(0,r.createElement)(l.Modal,{title:e,onRequestClose:s},(0,r.createElement)("form",{onSubmit:e=>{e.preventDefault(),i||d&&t({name:d,remoteUrl:p})}},(0,r.createElement)("div",{style:{marginTop:"1em"}},(0,r.createElement)(l.__experimentalInputControl,{value:d,label:(0,o.__)("File name"),autoFocus:!0,onChange:e=>{u(e||"")}})),(0,r.createElement)("div",{style:{marginTop:"1em"}},(0,r.createElement)(l.__experimentalInputControl,{value:p,label:(0,o.__)("Load content from remote URL (optional)"),onChange:e=>{m(e||"")}})),i&&(0,o.__)("Fetching the remote file..."),n&&(0,r.createElement)("p",{style:{color:"red",marginTop:"1em"}},(0,o.__)("The file could not be fetched. Check the browser dev tools for more information.")),(0,r.createElement)("br",null),(0,r.createElement)(l.Button,{variant:"primary",type:"submit"},(0,o.__)("Done"))))}const s=(0,a.forwardRef)((function({updateFile:e,addFile:t,setActiveFileIndex:n,files:l,activeFileIndex:s},c){const[d,u]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),[_,f]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!1);async function w(e){if(e.remoteUrl){f(!0);try{const t=await fetch(e.remoteUrl,{credentials:"omit"});e.contents=await t.text()}finally{f(!1)}}return e}return(0,a.useImperativeHandle)(c,(()=>({setEditFileNameModalOpen:e=>{h(!1),m(e)},setNewFileModalOpen:e=>{h(!1),u(e)}}))),(0,r.createElement)(r.Fragment,null,p&&(0,r.createElement)(i,{title:(0,o.__)("Edit file name or URL"),file:l[s],onRequestClose:()=>m(!1),onSave:async function(t){h(!1);try{const n=await w(t);e((e=>({...e,...n}))),m(!1)}catch(e){h(!0)}},isLoading:_,error:g}),d&&(0,r.createElement)(i,{title:(0,o.__)("Create new file"),onRequestClose:()=>u(!1),onSave:async function(e){h(!1);try{const r=await w({contents:"",...e});t(r),n(l.length),u(!1)}catch(e){h(!0)}},isLoading:_,error:g}))}))},543:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{Z:()=>j});var a=n(196),o=n(731),l=n(329),i=n(390),s=n(495),c=n(294),d=n(97),u=n(803),p=n(885),m=n(307),_=n(609),f=n(869),g=n(438),h=n(270),w=n(696),b=n(611),y=n(674),E=n(742),v=n(921),C=n(135),P=n(839),k=n(562),T=n(779),x=n.n(T),N=n(781),S=n(815),$=n(982),F=n(262),R=e([p,C,P,k,S]);[p,C,P,k,S]=R.then?(await R)():R;const L={css:(0,s.iv)(),html:(0,i.dy)(),js:(0,c.eJ)(),jsx:(0,c.eJ)({jsx:!0}),json:(0,d.AV)(),php:(0,u.h)()};function I(e){const t=new URL(e,"https://playground.wordpress.net");return t.searchParams.has("__playground_refresh")?t.searchParams.delete("__playground_refresh"):t.searchParams.set("__playground_refresh","1"),t.pathname+t.search}function U({inBlockEditor:e,blueprint:t,blueprintUrl:n,configurationSource:r,codeEditor:i,codeEditorMode:s,codeEditorSideBySide:c,codeEditorReadOnly:d,codeEditorTranspileJsx:u,constants:T,logInUser:R,createNewPost:U,createNewPostType:j="post",createNewPostTitle:B=(0,$._x)("New post","default title of new post created by blueprint"),createNewPostContent:O="",redirectToPost:A,redirectToPostType:Z="front",landingPageUrl:W="/",files:J,showAddNewFile:D=!1,showFileControls:M=!1,codeEditorErrorLog:V=!1,requireLivePreviewActivation:G=!0,inFullPageView:q=!1,baseAttributesForFullPageView:z={},onStateChange:K,speak:H}){const{files:X,addFile:Y,isLoading:Q,updateFile:ee,removeFile:te,activeFile:ne,activeFileIndex:re,setActiveFileIndex:ae}=(0,v.ZP)(J||[],{withErrorLog:V,getErrors:async()=>await(se.current?.readFileAsText("/internal/stderr"))||""}),oe=(0,m.useRef)(null),le=(0,m.useRef)(null),ie=(0,m.useRef)(null),se=(0,m.useRef)(null),ce=(0,m.useRef)(null),de=(0,m.useRef)(null),ue=(0,m.useRef)(null);(0,m.useEffect)((()=>{if(!ue.current)return;const e=ue.current.view;if(e)return e.dom.addEventListener("keydown",t),e.dom.addEventListener("keypress",t),e.dom.addEventListener("keyup",t),()=>{e.dom.removeEventListener("keydown",t,!0),e.dom.removeEventListener("keyup",t,!0),e.dom.removeEventListener("keypress",t,!0)};function t(e){e.stopPropagation()}}),[ue.current]);const[pe,me]=(0,m.useState)(!G),[_e,fe]=(0,m.useState)(0),ge="playground-block-dismiss-exit-editor-tip",[he,we]=(0,m.useState)("true"===localStorage[ge]);function be(){de?.current&&de.current.focus(),localStorage[ge]="true",we(!0),H(
// translators: This describes a UI notice that has been dismissed by the user.
(0,$.__)("Notice dismissed."),"polite")}(0,m.useEffect)((()=>{K?.({client:se.current,postId:_e,files:X})}),[se.current,_e,X]);const ye=ne?.name.split(".").pop();(0,m.useEffect)((()=>{!async function(){if(!pe)return;if(!oe.current)return;let e;try{"blueprint-json"===r?t&&(e=JSON.parse(t)):"blueprint-url"===r?n&&(e=await fetch(n).then((e=>e.json()))):e={preferredVersions:{wp:"latest",php:"7.4"},steps:[{step:"defineWpConfigConsts",consts:T},R&&{step:"login",username:"admin",password:"password"}]}}catch(e){console.error(e)}const a={iframe:oe.current,remoteUrl:"https://wasm.wordpress.net/remote.html"};e&&(a.blueprint=e),console.log("Initializing Playground");const o=await(0,p.startPlaygroundWeb)(a);if(await o.isReady(),se.current=o,setTimeout((()=>H(
// translators: This says that the Playground preview has loaded.
(0,$.__)("WordPress Playground loaded."),"polite")),500),await Ce(),"block-attributes"===r){let e=0;if(U){const t=await o.documentRoot,{text:n}=await o.run({code:`<?php\n\t\t\t\t\t\trequire("${t}/wp-load.php");\n\n\t\t\t\t\t\t$post_id = wp_insert_post([\n\t\t\t\t\t\t\t'post_title' => ${(0,p.phpVar)(B)},\n\t\t\t\t\t\t\t'post_content' => ${(0,p.phpVar)(O)},\n\t\t\t\t\t\t\t'post_status' => 'publish',\n\t\t\t\t\t\t\t'post_type' => ${(0,p.phpVar)(j)},\n\t\t\t\t\t\t]);\n\n\t\t\t\t\t\techo $post_id;\n\t\t\t\t\t`});fe(parseInt(n)),e=parseInt(n)}const t=function(e=_e){if(U&&A){if("front"===Z)return`/?p=${e}`;if("admin"===Z)return`/wp-admin/post.php?post=${e}&action=edit`}return W}(e);await o.goTo(t)}else e||await o.goTo("/")}()}),[pe,t,n,r,R,W,T,U,j,B,O,A,Z]);const[Ee,ve]=(0,m.useState)([]);async function Ce(){if(!se.current||!i)return;ve([]);const e=se.current;let t=X;if(u){const{failures:e,transpiledFiles:n}=await(0,S.U)(t);if(e.length){for(const t of e)console.error(`Failed to transpile ${t.file.name}:`,t.error);return void ve(e)}t=n}"theme"===s?await(0,P.A)(e,t):await(0,C.o)(e,t)}const Pe=(0,a.useCallback)((()=>{pe?async function(){await Ce();const e=await se.current.getCurrentURL();await se.current.goTo(I(e))}():me(!0)}),[Ce]),ke=(0,a.useMemo)((()=>l.$f.of([{key:"Mod-s",run:()=>(Pe(),!0)}])),[Pe]),Te=x()("wordpress-playground-main-container",{"is-full-page-view":q}),xe=x()("wordpress-playground-content-container",{"is-one-under-another":!c,"is-side-by-side":c}),Ne=(0,$.__)("This button runs the code in the Preview iframe. If the Preview iframe has not yet been activated, this button creates the Preview iframe which contains a full WordPress website and may be a challenge for screen readers."),Se=(0,$.__)("This button creates the Preview iframe containing a full WordPress website which may be a challenge for screen readers."),$e=se.current?
// translators: State of the playground iframe after it has loaded.
(0,$.__)("Loaded"):
// translators: State of the playground iframe while it is loading.
(0,$.__)("Loading"),Fe=(0,$.__)("Not Activated"),Re=(0,$.g)(
// translators: %s: status of the Playground preview
(0,$.__)("Beginning of Playground Preview - %s"),pe?$e:Fe);return(0,a.createElement)("section",{"aria-label":(0,$.__)("WordPress Playground"),className:Te},(0,a.createElement)("div",{className:xe},i&&(0,a.createElement)("div",{className:"code-container"},(0,a.createElement)(N.Z,{ref:ce,updateFile:ee,addFile:Y,setActiveFileIndex:ae,files:X,activeFileIndex:re}),(0,a.createElement)("div",{className:"file-tabs"},Q?(0,a.createElement)("div",{className:"file-tab file-tab-loading"},(0,a.createElement)(_.Spinner,null)," ",(0,$.__)("Loading files...")):X.map(((t,n)=>(0,a.createElement)(_.Button,{key:t.name,variant:"primary",className:`file-tab ${n===re&&"file-tab-active"}`,"aria-label":d||(0,v.DR)(t)?(0,$.g)(
// translators: %s is a file name
(0,$.__)("Read-only file: %s"),t.name):(0,$.g)(
// translators: %s is a file name
(0,$.__)("File: %s"),t.name),"aria-current":n===re?"true":"false",onClick:()=>{ae(n)},onDoubleClick:()=>{ce.current?.setEditFileNameModalOpen(!0)}},e&&t.remoteUrl?(0,a.createElement)(f.Z,{icon:g.Z}):"",t.name))),D&&(0,a.createElement)(_.Button,{"aria-label":
// translators: add source code file to code editor
(0,$.__)("Add File"),variant:"secondary",className:"file-tab file-tab-extra",onClick:()=>ce.current?.setNewFileModalOpen(!0)},(0,a.createElement)(f.Z,{icon:h.Z})),(0,a.createElement)(_.Button,{ref:de,"aria-label":(0,$.__)("Download Code as a Zip file"),variant:"secondary",className:"file-tab file-tab-extra",onClick:()=>{se.current&&(0,k.Z)(se.current,s)}},(0,a.createElement)(f.Z,{icon:w.Z}))),!he&&(0,a.createElement)("button",{type:"button",className:"playground-block-exit-editor-tip",onClick:be,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),be())}},(0,m.createInterpolateElement)(
// translators: This is a keyboard combination to exit the code editor.
(0,$.__)("Press <EscapeKey />, <TabKey /> to exit the editor. <DismissNotice />"),{EscapeKey:(0,a.createElement)("code",{"aria-label":
// translators: The keyboard's Escape key
(0,$.__)("Escape key")},"Esc"),TabKey:(0,a.createElement)("code",{"aria-label":
// translators: The keyboard's Tab key
(0,$.__)("Tab key")},"Tab"),DismissNotice:(0,a.createElement)("span",{className:"playground-block-exit-editor-tip-dismiss-notice"},(0,$.__)("(Click to dismiss this notice.)"))})),(0,a.createElement)("div",{className:"code-editor-wrapper"},(0,a.createElement)(o.ZP,{ref:ue,value:ne.contents,extensions:[ke,l.tk.lineWrapping,...(Le=ye||"js",Le in L?[L[Le]]:[])],readOnly:d&&!e||(0,v.DR)(X[re]),onChange:e=>ee((t=>({...t,contents:e})))})),(0,a.createElement)("div",{className:"actions-bar"},M?(0,a.createElement)("div",{className:"file-actions"},!ne&&(0,a.createElement)("button",{type:"button",onClick:()=>{ce.current?.setEditFileNameModalOpen(!0)},className:"wordpress-playground-block-button button-non-destructive"},(0,a.createElement)(f.Z,{icon:b.Z})," ",
// translators: edit source code file name
(0,$.__)("Edit file name")),!(0,v.DR)(ne)&&X.filter((e=>!(0,v.DR)(e))).length>1&&(0,a.createElement)("button",{type:"button",className:"wordpress-playground-block-button button-destructive",onClick:()=>{ae(0),te(re)}},(0,a.createElement)(f.Z,{icon:y.Z})," ",
// translators: remove file from code editor
(0,$.__)("Remove file"))):(0,a.createElement)("div",{className:"file-actions"}),(0,a.createElement)(_.Button,{variant:"primary",icon:"controls-play",iconPosition:"right",onClick:()=>{Pe()},className:"wordpress-playground-run-button","aria-description":G?Ne:void 0},
// translators: verb: run code in Playground
(0,$.__)("Run")))),(0,a.createElement)("div",{className:"playground-container"},!q&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("span",{className:"screen-reader-text wordpress-playground-before-preview",tabIndex:-1,ref:le},Re),(0,a.createElement)("a",{href:"#",className:"screen-reader-text",onClick:e=>{e.preventDefault(),ie.current&&ie.current.focus()}},
// translators: verb: skip over the playground iframe
(0,$.__)("Skip Playground Preview"))),!pe&&(0,a.createElement)("div",{className:"playground-activation-placeholder"},(0,a.createElement)(_.Button,{className:"wordpress-playground-activate-button",variant:"primary",onClick:()=>{me(!0),le.current&&le.current.focus()},"aria-description":Se},(0,$.__)("Activate Live Preview"))),Ee?.length>0&&(0,a.createElement)("div",{className:"playground-transpilation-failures"},(0,a.createElement)("h3",null,(0,$.__)("Transpilation Error")),(0,a.createElement)("p",null,(0,$.__)("There were errors while transpiling the code. Please fix the errors and try again.")),(0,a.createElement)("ul",null,Ee.map((({file:e,error:t})=>(0,a.createElement)("li",{key:e.name},(0,a.createElement)("b",null,e.name),(0,a.createElement)("p",null,t.message)))))),pe&&(0,a.createElement)("iframe",{"aria-label":(0,$.__)("Live Preview in WordPress Playground"),key:"playground-iframe",ref:oe,className:"playground-iframe"}),!q&&(0,a.createElement)("span",{className:"screen-reader-text wordpress-playground-end-of-preview",tabIndex:-1,ref:ie},
// translators: screen reader text noting end of Playground preview
(0,$.__)("End of Playground Preview")))),(0,a.createElement)("footer",{className:"wordpress-playground-footer"},(0,a.createElement)("a",{href:"https://w.org/playground",className:"wordpress-playground-footer__powered_by_link",target:"_blank","aria-label":(0,$.__)("Powered by WordPress Playground")},(0,m.createInterpolateElement)(
// translators: powered-by label with embedded icon. please leave markup tags intact, including numbering.
(0,$.__)("<span1>Powered by</span1><WordPressIcon /><span2>WordPress Playground</span2>"),{span1:(0,a.createElement)("span",{className:"wordpress-playground-footer__powered_text"}),WordPressIcon:(0,a.createElement)(a.Fragment,null,(0,a.createElement)("span",{className:"wordpress-playground-footer__spacing"}," "),(0,a.createElement)(f.Z,{icon:E.Z,className:"wordpress-playground-footer__icon"})),span2:(0,a.createElement)("span",{className:"wordpress-playground-footer__powered_by_link-text"})})),!e&&!q&&(0,a.createElement)(_.Button,{variant:"link",className:"wordpress-playground-footer__full-page-link",onClick:()=>{window.open(function(){const e=new URL(location.href);e.search="?playground-full-page";const t={...z,requireLivePreviewActivation:!1,files:X.filter((e=>!(0,v.DR)(e)))},n=(0,F.Ne)(JSON.stringify((0,F.Ul)(t)));return e.searchParams.append("playground-attributes",n),e.toString()}(),"_blank")},"aria-label":(0,$.__)("Open in New Tab")},(0,$.__)("Open in New Tab"))));var Le}const j=(0,_.withSpokenMessages)(U);r()}catch(B){r(B)}}))},815:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{U:()=>c});var a=n(885),o=e([a]);let l,i;a=(o.then?(await o)():o)[0];const s=/^(?:[ \t]*<\?php)?[ \t/*#@]*Plugin Name:(.*)$/im,c=async e=>{void 0===l&&(l=n.e(449).then(n.t.bind(n,449,23)),i=(await l).initialize({worker:!0,wasmURL:new URL("./esbuild.wasm",document.currentScript.src)}));const t=e.map((async t=>{if(t.name.match(/(\/|^)block.json$/))return[t,{name:t.name+".esmodule.js",contents:`export default ${t.contents}`}];if(t.name.endsWith(".php")&&s.test(t.contents.substring(0,4096)))return[{...t,contents:d(t.contents,e)}];if(t.name.endsWith(".js")){await i;try{const e=await(await l).transform(t.contents,{loader:"jsx",target:"esnext",jsxFactory:"wp.element.createElement",format:"esm"});return[{name:t.name+".src",contents:t.contents},{name:t.name,contents:e.code}]}catch(e){return[{file:t,error:e}]}}return[t]})),r=(await Promise.all(t)).flatMap((e=>e));return{transpiledFiles:r.filter((e=>"name"in e)),failures:r.filter((e=>void 0!==e.error))}};function d(e,t){const n=t.map((e=>e.name)).filter((e=>e.endsWith(".json"))),r=t.map((e=>e.name)).filter((e=>e.endsWith(".js"))).concat(n.map((e=>e+".esmodule.js")));return(e=e.trim()).endsWith("?>")||(e+="?>"),`${e}<?php\n\t// Preload ES Modules using <link rel="modulepreload" href="" /> to prevent a\n\t// "block isn't registered" warning in the editor. This ensures the registerBlockType()\n\t// call is done before the block is rendered.\n\tfunction playground_block_add_modulepreload_in_admin() {\n\t\t$js_relative_paths = ${(0,a.phpVar)(r)};\n\t\tforeach($js_relative_paths as $relative_path) {\n\t\t\t$file = basename($relative_path);\n\t\t\t$url = json_encode(plugins_url($relative_path, __FILE__));\n\t\t\t$script = <<<SCRIPT\n\t\t\t(function() {\n\t\t\t  const link = document.createElement("link");\n\t\t\t  link.rel = "modulepreload";\n\t\t\t  link.href = $url;\n\t\t\t  document.head.append(link);\n\t\t\t})();\nSCRIPT;\n\t\t\twp_add_inline_script('wp-blocks', $script);\n\t\t}\n\t}\n\tadd_action('enqueue_block_editor_assets', 'playground_block_add_modulepreload_in_admin');\n\t\n\t// Remap ESM imports from block.json, that aren't widely supported,\n\t// to imports from a JavaScript file, that are widely supported.\n\tfunction playground_wp_esm_import_map($import_map) {\n\t\t$json_paths = ${(0,a.phpVar)(n)};\n\t\t$json_mapping = array();\n\t\tforeach($json_paths as $json_path) {\n\t\t\t$json_path = plugins_url($json_path, __FILE__);\n\t\t\t$js_path = plugins_url($json_path . '.esmodule.js', __FILE__);\n\t\t\t$json_mapping[$json_path] = $js_path;\n\t\t}\n\t\treturn array_merge($import_map, $json_mapping);\n\t}\n\tadd_filter('wp_esm_import_map', 'playground_wp_esm_import_map');\n\t`}r()}catch(u){r(u)}}))},921:(e,t,n)=>{n.d(t,{DR:()=>i,ZP:()=>o});var r=n(307),a=n(982);function o(e,{withErrorLog:t=!1,getErrors:n}){const[o,s]=(0,r.useState)(e||[]),[c,d]=(0,r.useState)(0),u=o[c],p=(0,r.useCallback)(((e,t=c)=>{s(o.map(((n,r)=>r===t?e(n):n)))}),[c,o,s]),m=(0,r.useCallback)(((e=c)=>{s(o.filter(((t,n)=>n!==e)))}),[c]),_=(0,r.useCallback)(((e,t=o.length)=>{s([...o.slice(0,t),e,...o.slice(t)])}),[o,s]);async function f(e){try{const t=await fetch(e.remoteUrl),n=await t.text();p((e=>({...e,contents:n})),o.indexOf(e))}catch{p((t=>({...t,contents:(0,a.g)(/* translators: %s: A URL for a remote file. */
(0,a.__)("Failed to fetch the remote file from %s"),e.remoteUrl),name:(0,a.g)(/* translators: %s: A file name. */
(0,a.__)("%s (Failed to fetch)"),t.name)})),o.indexOf(e))}}const[g,h]=(0,r.useState)(o.filter((e=>e.remoteUrl)).length>0);return(0,r.useEffect)((()=>{!async function(){try{await Promise.all(o.filter((e=>e.remoteUrl)).map(f))}finally{h(!1)}}()}),[]),(0,r.useEffect)((()=>{!async function(){const e=o.findIndex(i);t?-1===e&&_({name:l,contents:await(n?.())||""},1):-1!==e&&m(e)}()}),[t]),(0,r.useEffect)((()=>{if(!t)return;const e=setInterval((async function(){const e=o.findIndex(i);if(-1===e)return;const t=await(n?.())||"";t!==o[e].contents&&p((e=>({...e,contents:t})),e)}),1e3);return()=>clearInterval(e)}),[t,o,n]),{files:o,addFile:_,isLoading:g,updateFile:p,removeFile:m,activeFile:u,activeFileIndex:c,setActiveFileIndex:d}}const l="PHP error_log";function i(e){return e.name===l}},135:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{o:()=>l});var a=n(885),o=e([a]);a=(o.then?(await o)():o)[0];const l=async(e,t)=>{const n=await e.documentRoot+"/wp-content/plugins/demo-plugin";await e.fileExists(n)&&await e.rmdir(n,{recursive:!0}),await e.mkdir(n);for(const r of t){const t=`${n}/${r.name}`,a=t.split("/").slice(0,-1).join("/");await e.mkdir(a),await e.writeFile(t,r.contents)}try{await(0,a.activatePlugin)(e,{pluginPath:n})}catch(e){console.error(e)}};r()}catch(e){r(e)}}))},839:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{A:()=>l});var a=n(885),o=e([a]);a=(o.then?(await o)():o)[0];const l=async(e,t)=>{const n="demo-theme",r=await e.documentRoot+"/wp-content/themes/"+n;await e.fileExists(r)&&await e.rmdir(r,{recursive:!0}),await e.mkdir(r);for(const n of t){const t=`${r}/${n.name}`,a=t.split("/").slice(0,-1).join("/");await e.mkdir(a),await e.writeFile(t,n.contents)}try{await(0,a.activateTheme)(e,{themeFolderName:n})}catch(e){console.error(e)}};r()}catch(e){r(e)}}))},882:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.r(t),n.d(t,{default:()=>m});var a=n(196),o=n(175),l=n(307),i=n(609),s=n(543),c=n(262),d=n(982),u=e([s]);s=(u.then?(await u)():u)[0];const m=(p=function({isSelected:e,setAttributes:t,attributes:n}){const{codeEditor:r,codeEditorReadOnly:l,codeEditorTranspileJsx:c,codeEditorSideBySide:u,codeEditorMultipleFiles:p,codeEditorMode:m,logInUser:_,landingPageUrl:f,createNewPost:g,createNewPostType:h,createNewPostTitle:w,createNewPostContent:b,redirectToPost:y,redirectToPostType:E,constants:v,blueprint:C,codeEditorErrorLog:P,blueprintUrl:k,configurationSource:T,requireLivePreviewActivation:x}=n,N="plugin"===m;return(0,a.createElement)("div",{...(0,o.useBlockProps)()},(0,a.createElement)(s.Z,{inBlockEditor:!0,showAddNewFile:p,showFileControls:e,onStateChange:({files:e})=>{t({files:e})},...n}),(0,a.createElement)(o.InspectorControls,null,(0,a.createElement)(i.Panel,{header:(0,d.__)("Settings")},(0,a.createElement)(i.PanelBody,{title:(0,d.__)("General"),initialOpen:!0},(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Require live preview activation"),help:x?(0,d.__)("User must click to load the preview."):(0,d.__)("Preview begins loading immediately."),checked:x,onChange:()=>{t({requireLivePreviewActivation:!x})}})),(0,a.createElement)(i.PanelBody,{title:(0,d.__)("Code editor"),initialOpen:!0},(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Code editor"),help:r?(0,d.__)("Code editor enabled."):(0,d.__)("Code editor disabled."),checked:r,onChange:()=>{t({codeEditor:!r})}}),r&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Side by side"),help:u?(0,d.__)("Code editor is to the left."):(0,d.__)("Code editor is at the top."),checked:u,onChange:()=>{t({codeEditorSideBySide:!u})}}),(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Read only"),help:l?(0,d.__)("Code editor is read only."):(0,d.__)("Code editor is editable."),checked:l,onChange:()=>{t({codeEditorReadOnly:!l})}}),(0,a.createElement)(i.RadioControl,{label:"Code editor mode",selected:m,options:[{label:"Plugin",value:"plugin"},{label:"Theme",value:"theme"}],onChange:e=>{t("theme"===e?{codeEditorMode:e,codeEditorTranspileJsx:!1}:{codeEditorMode:e})}}),N&&(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Transpile JSX to JS"),help:(0,d.__)("Transpiles JSX syntax to JS using esbuild. Only the JSX tags are transpiled. Imports and other advanced ES module syntax features are preserved."),checked:c,onChange:()=>{t({codeEditorTranspileJsx:!c})}}),(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Multiple files"),help:p?(0,d.__)("Multiple files allowed."):(0,d.__)("Single file allowed."),checked:p,onChange:()=>{t({codeEditorMultipleFiles:!p})}}),(0,a.createElement)(i.ToggleControl,{label:(0,d.__)('Include "error_log" file'),checked:P,onChange:()=>{t({codeEditorErrorLog:!P})}}),(0,a.createElement)("div",{style:{display:"none"}},(0,a.createElement)(i.SelectControl,{help:(0,a.createElement)("div",null,"Decide how your code from the editor will be used inside the Playground WordPress installation.",(0,a.createElement)("ul",null,(0,a.createElement)("li",null,(0,a.createElement)("strong",null,"Plugin"),": all the files will be placed in a separate plugin which will be automatically enabled in the Playground."),(0,a.createElement)("li",null,(0,a.createElement)("strong",null,"Editor script"),": the code will be executed directly in the Gutenberg editor (using"," ",(0,a.createElement)("code",null,(0,a.createElement)("small",null,"wp_add_inline_script"))," ","with"," ",(0,a.createElement)("code",null,(0,a.createElement)("small",null,"wp-block")),"dependency)"))),label:"Mode",options:[{disabled:!0,label:"Select an Option",value:""},{label:"Editor script",value:"editor-script"},{label:"Plugin",value:"plugin"}],value:m,onChange:e=>{t({codeEditorMode:e})}})))),(0,a.createElement)(i.PanelBody,{title:(0,d.__)("Blueprint"),initialOpen:!1},(0,a.createElement)(i.SelectControl,{label:(0,d.__)("Blueprint source"),value:T,options:[{label:(0,d.__)("Generate from block attributes","source of Blueprint content"),value:"block-attributes"},{label:(0,d._x)("URL","source of Blueprint content"),value:"blueprint-url"},{label:(0,d._x)("JSON (paste it below)","source of Blueprint content"),value:"blueprint-json"}],onChange:e=>{t({configurationSource:e})},help:(0,d.__)("Playground is configured using Blueprints. Select the source of the Blueprint you'd like to use for this Playground instance.")}),"block-attributes"===T&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Log in automatically"),help:_?(0,d.__)("User will be logged in."):(0,d.__)("User won't be logged in."),checked:_,onChange:()=>{t({logInUser:!_})}}),(0,a.createElement)(i.ToggleControl,{label:(0,d.__)("Create new post or page"),help:g?(0,d.__)("New post or page will be created."):(0,d.__)("No new posts or pages will be created."),checked:g,onChange:()=>{t({createNewPost:!g})}}),g&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(i.__experimentalToggleGroupControl,{label:(0,d._x)("Create new: post type","optional blueprint step"),value:h,onChange:e=>{t({createNewPostType:e?.toString()})},isBlock:!0},(0,a.createElement)(i.__experimentalToggleGroupControlOption,{value:"post",label:(0,d._x)("Post","noun: WordPress post type")}),(0,a.createElement)(i.__experimentalToggleGroupControlOption,{value:"page",label:(0,d._x)("Page","noun: WordPress post type")})),(0,a.createElement)(i.__experimentalInputControl,{value:w,onChange:e=>{t({createNewPostTitle:e})},label:(0,d._x)("Create new: title","title for new post or page created by blueprint"),placeholder:(0,d._x)("Hello World!","placeholder text: title for new post or page created by blueprint")}),(0,a.createElement)(i.TextareaControl,{value:b,onChange:e=>{t({createNewPostContent:e})},label:(0,d._x)("Create new: content","content for new post or page created by blueprint"),help:(0,d.__)("Gutenberg editor content of the post")}),(0,a.createElement)(i.ToggleControl,{label:(0,d._x)("Create new: redirect to post","optional blueprint step"),help:y?(0,d.__)("User will be redirected."):(0,d.__)("User won't be redirected."),checked:y,onChange:()=>{t({redirectToPost:!y})}}),y&&(0,a.createElement)(i.__experimentalToggleGroupControl,{label:
// translators: how to redirect to post created by blueprint
(0,d.__)("Create new redirect: redirect to"),value:E,onChange:e=>{t({redirectToPostType:e?.toString()})},isBlock:!0},(0,a.createElement)(i.__experimentalToggleGroupControlOption,{value:"front",label:
// translators: place to view the post created by blueprint
(0,d._x)("Front page","post created by blueprint")}),(0,a.createElement)(i.__experimentalToggleGroupControlOption,{value:"admin",label:
// translators: place to edit the post created by blueprint
(0,d._x)("Edit screen","post created by blueprint")}))),(!g||!y)&&(0,a.createElement)(i.__experimentalInputControl,{value:f,onChange:e=>{t({landingPageUrl:e})},label:(0,d._x)("Landing page","where to redirect after Playground is loaded"),help:(0,d.__)("Define where to redirect after Playground is loaded."),placeholder:(0,d.__)("URL to redirect to after load (eg. /wp-admin/)")}),["WP_DEBUG","WP_SCRIPT_DEBUG"].map((e=>(0,a.createElement)(i.ToggleControl,{key:e,label:e,help:v[e]?`${e}=true`:`${e}=false`,checked:!!v[e],onChange:()=>{t({constants:{...v,[e]:!v[e]}})}})))),"blueprint-url"===T&&(0,a.createElement)(i.__experimentalInputControl,{value:k,onChange:e=>{t({blueprintUrl:e})},label:(0,d.__)("Blueprint URL"),help:(0,d.__)("Load Blueprint from this URL."),placeholder:(0,d.__)("URL to load the Blueprint from")}),"blueprint-json"===T&&(0,a.createElement)(i.TextareaControl,{value:C,onChange:e=>{t({blueprint:e})},label:(0,d._x)("Blueprint","raw Blueprint JSON"),help:(0,d.__)("JSON file with playground blueprint")})))))},e=>{const t=(0,l.useRef)({encodeTimeout:null}),[n,r]=(0,l.useState)((()=>{const t={};for(const n in e.attributes)c._J.includes(n)&&(t[n]=e.attributes[n]);return(0,c.tg)(t)})),o={};for(const t in e.attributes)c._J.includes(t)||(o[t]=e.attributes[t]);return(0,a.createElement)(p,{...e,setAttributes:function(a){const o={},l={};for(const e in a)c._J.includes(e)?o[e]=a[e]:l[e]=a[e];Object.keys(l).length>0&&e.setAttributes(l);const i={...n,...o};Object.keys(o).length>0&&r(i),t.current.encodeTimeout&&clearTimeout(t.current.encodeTimeout),t.current.encodeTimeout=setTimeout((()=>{e.setAttributes((0,c.Ul)(i)),clearTimeout(t.current.encodeTimeout),t.current.encodeTimeout=null}),100)},attributes:{...o,...n}})});r()}catch(e){r(e)}var p}))}}]);